# PDF2LLM-Tuning-Studio

PDF ë¬¸ì„œì—ì„œ ì§€ì‹ì„ ì¶”ì¶œí•˜ê³  ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸(LLM)ì„ íš¨ìœ¨ì ìœ¼ë¡œ íŒŒì¸íŠœë‹í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ íŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤. GPU ê°€ì† PDF íŒŒì‹±ê³¼ ìµœì í™”ëœ LLM íŒŒì¸íŠœë‹ì„ ê²°í•©í•˜ì—¬ ë¬¸ì„œ ê¸°ë°˜ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

## ğŸ“š ì£¼ìš” ê¸°ëŠ¥

- **GPU ê°€ì† PDF ì¶”ì¶œ**: Unstructured ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ NVIDIA GPUë¥¼ í™œìš©í•œ ê³ ì† í…ìŠ¤íŠ¸ ì¶”ì¶œ
- **Q&A ìë™ ìƒì„±**: Amazon Bedrock Claude ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ê³ í’ˆì§ˆ ì§ˆë¬¸-ë‹µë³€ ìŒ ìƒì„±
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì  íŒŒì¸íŠœë‹**: Unsloth ìµœì í™”ì™€ LoRA ì–´ëŒ‘í„°ë¡œ ì œí•œëœ GPU í™˜ê²½ì—ì„œë„ ëŒ€í˜• ëª¨ë¸ í•™ìŠµ ê°€ëŠ¥
- **ì™„ì „ ìë™í™” íŒŒì´í”„ë¼ì¸**: PDF ë¬¸ì„œ ì…ë ¥ë¶€í„° ë§ì¶¤í˜• LLM ëª¨ë¸ ì¶œë ¥ê¹Œì§€ ìë™í™”

## ğŸ” í”„ë¡œì íŠ¸ êµ¬ì¡°

```
PDF2LLM-Tuning-Studio/
â”œâ”€â”€ assets/                  # ê³µí†µ ë¦¬ì†ŒìŠ¤ (ì´ë¯¸ì§€, ìœ í‹¸ë¦¬í‹°)
â”‚   â”œâ”€â”€ images/              # ë‹¤ì´ì–´ê·¸ë¨ ë° ì´ë¯¸ì§€
â”‚   â””â”€â”€ utils/               # ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚
â”œâ”€â”€ pdf_qa_extraction/       # PDF ì²˜ë¦¬ ë° Q&A ì¶”ì¶œ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ Dockerfile           # GPU ì§€ì› PDF ì¶”ì¶œ ì»¨í…Œì´ë„ˆ
|   |â”€â”€ Dockerfile_event_eng # AWS Event ì‹¤ìŠµí”Œë ›í¼ì˜ ë„¤íŠ¸ì›Œí¬ íŒ¨í‚¤ì§€ ê²½ë¡œë¡œ ì¸í•œ Dockerfile ëŒ€ìš© 
â”‚   â”œâ”€â”€ processing_local.py  # ë¡œì»¬ ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ processing.py        #SageMaker Processing job entrypoint ë°°ì¹˜ì¡ ì‹¤í–‰íŒŒì¼
â”‚   â”œâ”€â”€ sagemaker_processingjob_pdf_qa_extraction.ipynb # SageMaker Processingì„ í™œìš©í•œ PDF ê¸°ë°˜ QA ë°ì´í„° ìƒì„± ë°°ì¹˜ íŒŒì´í”„ë¼ì¸ ìë™í™” ë°ëª¨
â”‚   â””â”€â”€ README.md            # PDF ì¶”ì¶œ ê°€ì´ë“œ
â”‚
â””â”€â”€ fine_tuning/             # LLM íŒŒì¸íŠœë‹ ëª¨ë“ˆ
    â”œâ”€â”€ 01_setup_environment.ipynb        # í™˜ê²½ ì„¤ì •
    â”œâ”€â”€ 02_data_preprocessing_and_analysis.ipynb  # ë°ì´í„° ì „ì²˜ë¦¬
    â”œâ”€â”€ 03_train_unsloth_model.ipynb      # Unsloth ëª¨ë¸ í›ˆë ¨
    â””â”€â”€ README.md            # íŒŒì¸íŠœë‹ ê°€ì´ë“œ
```

## ğŸš€ ì‹œì‘ ê°€ì´ë“œ

### 1ë‹¨ê³„: PDF í…ìŠ¤íŠ¸ ë° Q&A ì¶”ì¶œ

Cuda ì»¨í…Œì´ë„ˆë¥¼ ë¹Œë“œí•´ë³´ê³ , GPUì¸ìŠ¤í„´ìŠ¤ í„°ë¯¸ë„ì—ì„œ PDF ë¬¸ì„œì—ì„œ í…ìŠ¤íŠ¸ ë¸”ë¡ì„ ì¶”ì¶œí•˜ê³  ê³ í’ˆì§ˆ Q&A ìŒì„ ìƒì„±í•©ë‹ˆë‹¤.

#### PDF í…ìŠ¤íŠ¸ ë° Q&A ì¶”ì¶œ

PDF ë¬¸ì„œ ì²˜ë¦¬ ë° Q&A ì¶”ì¶œì„ ìœ„í•œ Docker í™˜ê²½ì„ ì„¤ì •í•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [PDF Q&A ì¶”ì¶œ ê°€ì´ë“œ](./pdf_qa_extraction/README.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

```bash
cd pdf_qa_extraction
# Docker ë¹Œë“œ ë° ì‹¤í–‰ ì§€ì¹¨ì€ PDF Q&A ì¶”ì¶œ ê°€ì´ë“œ ì°¸ì¡°
```

ì´ ëª¨ë“ˆì—ì„œ ìˆ˜í–‰ë˜ëŠ” ì‘ì—…:
- NVIDIA GPU ê°€ì† PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ
- Amazon Bedrock Claudeë¥¼ í™œìš©í•œ ê³ í’ˆì§ˆ Q&A ìŒ ìƒì„±
- ë¬¸ì„œ ë„ë©”ì¸ ê¸°ë°˜ ë§ì¶¤í˜• ì§ˆë¬¸ ìƒì„±
- SageMaker Processing ë°°ì¹˜ ì‘ì—…ìœ¼ë¡œ ìë™í™”ëœ PDF ë¬¸ì„œ ì²˜ë¦¬ ë°°ì¹˜ í”„ë¡œì„¸ìŠ¤


### 2ë‹¨ê³„: ë°ì´í„° ì „ì²˜ë¦¬ ë° ë¶„ì„

ìƒì„±ëœ Q&A ë°ì´í„°ë¥¼ íŒŒì¸íŠœë‹ì— ì í•©í•œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì´ ë‹¨ê³„ì—ì„œëŠ” ë°ì´í„° í’ˆì§ˆì„ ê²€ì¦í•˜ê³  ëª¨ë¸ í•™ìŠµì— ìµœì í™”ëœ í˜•íƒœë¡œ ì¤€ë¹„í•©ë‹ˆë‹¤.

ë°ì´í„° ì „ì²˜ë¦¬ ë° ë¶„ì„ì€ `fine_tuning/02_data_preprocessing_and_analysis.ipynb` ë…¸íŠ¸ë¶ì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤.

ìì„¸í•œ ë‚´ìš©ì€ [LLM íŒŒì¸íŠœë‹ ê°€ì´ë“œ](./fine_tuning/README.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

ì´ ë…¸íŠ¸ë¶ì—ì„œ ìˆ˜í–‰ë˜ëŠ” ì‘ì—…:
- ë¬¸ì„œì—ì„œ ì¶”ì¶œí•œ ë°ì´í„° í’ˆì§ˆ ê²€ì¦ (ì¤‘ë³µ/ì§§ì€ ì‘ë‹µ ì œê±°)
- í†µê³„ ë¶„ì„ ë° ì‹œê°í™”
- í•™ìŠµ/ê²€ì¦ ë°ì´í„°ì…‹ ë¶„í• 
- ëª¨ë¸ í•™ìŠµìš© ì…ë ¥ í¬ë§·ìœ¼ë¡œ ë³€í™˜

### 3ë‹¨ê³„: LLM íŒŒì¸íŠœë‹

Unslothì™€ LoRA ì–´ëŒ‘í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ íŒŒì¸íŠœë‹ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

íŒŒì¸íŠœë‹ì€ `fine_tuning/03_train_unsloth_model.ipynb` ë…¸íŠ¸ë¶ì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤.
ìì„¸í•œ ë‚´ìš©ì€ [LLM íŒŒì¸íŠœë‹ ê°€ì´ë“œ](./fine_tuning/README.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.


ì£¼ìš” ë‹¨ê³„:
1. ëª¨ë¸ ë¡œë“œ ë° ì–‘ìí™” ì„¤ì •
2. LoRA ì–´ëŒ‘í„° êµ¬ì„±
3. í•™ìŠµ ë°ì´í„° ì¤€ë¹„
4. ëª¨ë¸ í›ˆë ¨
5. ì¶”ë¡  ë° í…ŒìŠ¤íŠ¸

## ğŸ’¡ ê¸°ìˆ  ìŠ¤íƒ

- **PDF ì¶”ì¶œ**: Unstructured, CUDA, Docker
- **ì§ˆë¬¸-ë‹µë³€ ìƒì„±**: Amazon Bedrock Claude
- **ëª¨ë¸ íŒŒì¸íŠœë‹**: Unsloth, PyTorch, LoRA
- **ì§€ì› ëª¨ë¸**: Llama, Mistral, Gemma, Qwen ë“± ë‹¤ì–‘í•œ ì˜¤í”ˆì†ŒìŠ¤ LLM

## ğŸ“Š ì„±ëŠ¥ ë° ìš”êµ¬ì‚¬í•­

### í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­

- **PDF ì¶”ì¶œ**: NVIDIA GPU (CUDA ì§€ì›)
- **íŒŒì¸íŠœë‹**: ìµœì†Œ 8GB VRAM (16GB+ ê¶Œì¥)

### ìµœì í™” íŒ

1. **PDF ì²˜ë¦¬**:
   - ëŒ€ìš©ëŸ‰ PDF(100MB+)ëŠ” ë¶„í•  ì²˜ë¦¬
   - `batch_size` íŒŒë¼ë¯¸í„°ë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¡°ì ˆ

2. **ëª¨ë¸ íŒŒì¸íŠœë‹**:
   - 4ë¹„íŠ¸ ì–‘ìí™”ë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 75% ê°ì†Œ
   - `gradient_checkpointing="unsloth"`ë¡œ 30% ì¶”ê°€ VRAM ì ˆì•½
   - `batch_size`ì™€ `gradient_accumulation_steps` ì¡°ì •ìœ¼ë¡œ ë©”ëª¨ë¦¬-ì†ë„ ê· í˜•

## ğŸ”— í™•ì¥ ê°€ëŠ¥ì„±

- **ì¶”ê°€ ëª¨ë¸ ì§€ì›**: ìƒˆë¡œìš´ ì˜¤í”ˆì†ŒìŠ¤ LLM ëª¨ë¸ ì ìš©
- **ë‹¤êµ­ì–´ ì§€ì›**: ë‹¤ì–‘í•œ ì–¸ì–´ ë¬¸ì„œ ì²˜ë¦¬
- **SageMaker í†µí•©**: AWS í™˜ê²½ì—ì„œ ëŒ€ê·œëª¨ íŒŒì¸íŠœë‹
- **RAG ì‹œìŠ¤í…œ êµ¬ì¶•**: ë¬¸ì„œ ì„ë² ë”©ìœ¼ë¡œ ê²€ìƒ‰ ì¦ê°• ìƒì„± ì‹œìŠ¤í…œ ê°œë°œ

---

> ê° ëª¨ë“ˆì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” í•´ë‹¹ ë””ë ‰í† ë¦¬ì˜ README íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”:
> - PDF Q&A ì¶”ì¶œ ê°€ì´ë“œ
> - LLM íŒŒì¸íŠœë‹ ê°€ì´ë“œ



## ğŸ“š ì°¸ê³  ìë£Œ

- [Unsloth: Accelerating LLM Fine-tuning](https://github.com/unslothai/unsloth)
- [Unstructured: Open-source PDF extraction](https://github.com/Unstructured-IO/unstructured)
- [Amazon Bedrock Documentation](https://docs.aws.amazon.com/bedrock/)
- [LoRA: Low-Rank Adaptation of Large Language Models](https://arxiv.org/abs/2106.09685)
- [Llama 3: Open Foundation and Fine-Tuned Chat Models](https://ai.meta.com/llama/)
- [Fine-Tuning Llama-3-1-8B for Function Calling using LoRA](https://medium.com/@gautam75/fine-tuning-llama-3-1-8b-for-function-calling-using-lora-159b9ee66060)
- [teddylee777: LangChain í•œêµ­ì–´ íŠœí† ë¦¬ì–¼](https://github.com/teddylee777/langchain-kr)